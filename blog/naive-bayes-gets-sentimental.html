<!doctype html> <html lang=en> <head> <meta charset=utf-8> <meta name=description content="A quick experiment with the wink-naive-bayes-text-classifier for negative/positive sentiment classification."> <meta http-equiv=content-language content=en> <meta name=viewport content="width=device-width, initial-scale=1"> <meta name=theme-color content="#6C307D"> <meta content="IE=edge,chrome=1" http-equiv=X-UA-Compatible> <title>Naive Bayes gets Sentimental : winkJS — NLP, Machine Learning & Stats in Node.js</title> <link href="/stylesheets/bootstrap.min.css" rel=stylesheet /><link href="/stylesheets/master.css" rel=stylesheet /><link href="/stylesheets/atom-one-dark.css" rel=stylesheet /> <script src="/javascripts/all.js"></script> <link rel=icon type="image/png" href="favicon.png"> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-47082559-2"></script> <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-47082559-2');
    </script> <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro" rel=stylesheet> <script src="https://use.typekit.net/cwc1qce.js"></script> <script>try{Typekit.load({ async: true });}catch(e){}</script> </head> <body class="blog blog_naive-bayes-gets-sentimental"> <header> <nav class="navbar navbar-inverse navbar-fixed-top"> <div class=container> <div class=navbar-header> <button type=button class="navbar-toggle collapsed" data-toggle=collapse data-target="#main-nav" aria-expanded=false> <span class=sr-only>Toggle navigation</span> <span class=icon-bar></span> <span class=icon-bar></span> <span class=icon-bar></span> </button> <a href="/" title=wink class=navbar-brand> 32 </a> <h1 class=screen-reader-text>Wink JS - NLP, Machine Learning & Stats</h1> </div> <ul class="nav navbar-nav navbar-right collapse navbar-collapse" id=main-nav> <li><a href="/wink-composer" class="">Wink Composer</a></li> <li><a href="/wink-nlp/getting-started.html" class="">Wink NLP</a></li> <li><a href="/examples.html" class="">Examples</a></li> <li><a href="/blog.html" class="">Blog</a></li> <li><a href="http://github.com/winkjs">Github</a></li> <li><a href="/about.html" class="">About</a></li> </ul> </div> </nav> </header> <div class="container blog"> <article class="col-md-8 col-md-offset-2"> <h2 class=blog-h1>Naive Bayes gets Sentimental</h2> <small> Mar 1, 2019 by <a href="https://twitter.com/R4CHN4">Rachna</a> </small> <main> <p>It was fun to watch <a href="https://www.npmjs.com/package/wink-sentiment"><code>wink-sentiment</code></a>’s stupidity in our <a href="https://winkjs.org/blog/sentimental-ai.html">previous post</a>. Humans express sentiments in complex ways. Therefore, mere dependence on lexical content can be misleading. Understanding rhetorical notes such as sarcasm, irony, or implications are largely driven by interplay of words. Forget machines, sometimes these expressions can even confuse human beings!</p> <p><a href="https://www.npmjs.com/package/wink-sentiment"><code>wink-sentiment</code></a> barely overcomes some of these challenges by handling negation, emoticons, contractions and common phrases. As a result, it delivers an accuracy of <strong>77%</strong> when tested on the Amazon Product Review <a href="https://archive.ics.uci.edu/ml/machine-learning-databases/00331/">Sentiment Labelled Sentences Data Set</a> from <a href="https://archive.ics.uci.edu/ml/index.php">UCI Machine Learning Repository</a>. While this is surely a quick way to get started, the only better way is to train machine on the task! The catch here is that we must have labeled data, which usually becomes a challenge. It is in these situations, <a href="https://www.npmjs.com/package/wink-sentiment"><code>wink-sentiment</code></a> comes to our rescue!</p> <p>I decided to setup a quick experiment with the <a href="https://www.npmjs.com/package/wink-naive-bayes-text-classifier"><code>wink-naive-bayes-text-classifier</code></a> for negative/positive sentiment classification. The Amazon Product Review data comes pre-labelled as 0 and 1 for Negative and Positive sentiment respectively; here is a sample:</p> <table> <thead> <tr> <th>Review</th> <th>Sentiment</th> </tr> </thead> <tbody> <tr> <td>It is unusable in a moving car at freeway speed.</td> <td>0</td> </tr> <tr> <td>I bought this to use with my Kindle Fire and absolutely loved it!</td> <td>1</td> </tr> <tr> <td>The commercials are the most misleading.</td> <td>0</td> </tr> <tr> <td>good protection and does not make phone too bulky.</td> <td>1</td> </tr> <tr> <td>I bought it for my mother and she had a problem with the battery.</td> <td>0</td> </tr> <tr> <td>Great Pocket PC / phone combination.</td> <td>1</td> </tr> </tbody> </table> <p>My immediate instinct was to remove stop words as they don’t have much value for a bag-of-words model, propagate negations to ensure phrases like “not good” are handled properly, and stem the words to make more general sense from them. For effective propagation of negation, expansion of contractions of form “Xn’t” to “X not” was also necessary. Here is how the preparatory tasks and configuration were set-up:</p> <pre><code class="javascript">nbc.definePrepTasks( [
  // Convert Xn't contractions to X not.
  nlp.string.amplifyNotElision,
  // Use simple tokenizer
  nlp.string.tokenize0,
  // Use stemmer to obtain base form of the word.
  nlp.tokens.stem,
  // Handle impact of negation
  nlp.tokens.propagateNegations,
  // Remove stop words
  nlp.tokens.removeWords
] );
// Configure behavior
nbc.defineConfig( { considerOnlyPresence: true, smoothingFactor: 0.5 } );</code></pre> <p>For validation, I first shuffled the data using <code>array.shuffle</code> utility from <a href="https://www.npmjs.com/package/wink-helpers"><code>wink-helpers</code></a> and subsequently partitioned it into training (80% i.e. 800 rows) and evaluation (20% i.e. 200 rows) sets. Note <a href="https://www.npmjs.com/package/wink-naive-bayes-text-classifier"><code>wink-naive-bayes-text-classifier</code></a> has a comprehensive API for evaluation but simplicity was our focus.</p> <blockquote> <p>It achieved an accuracy of <strong>85%</strong> – a solid <strong>8%</strong> jump from earlier 77% – as we were expecting! The question remained, is this the limit?</p> </blockquote> <p>Exploring <a href="https://www.npmjs.com/package/wink-perceptron">wink averaged perceptron</a> for sentiment analysis at this stage seemed a worthwhile idea. In order to prepare the input data, similar set-up as above was used. The tokens were converted to bag-of-words using the <a href="http://winkjs.org/wink-nlp-utils/tokens.html#bagOfWords"><code>tokens.bagOfWords</code></a> API from <a href="https://www.npmjs.com/package/wink-nlp-utils"><code>wink-nlp-utils</code></a>. I used <code>{ shuffleData: true, maxIterations: 6 }</code> as the hyperparameters for perceptron and got a marginal hike of <strong>0.5%</strong> over the naive bayes. But this was achieved with a small trick – the pocket perceptron approach – selected the best model from multiple runs!</p> <p>My curiosity didn’t end here and I couldn’t wait to experiment with our upcoming <strong><em>wink-nlp</em></strong>. It provides an API to compute document vector using the pre-trained <a href="https://en.wikipedia.org/wiki/Word_embedding">word vectors</a> that come out-of-the-box. As a result the bag-of-words model could now be easily replaced by document or sentence vectors. Word vectors provide a distinct advantage when it comes to handling out-of-vocabulary words.</p> <blockquote> <p>This time perceptron delivered an accuracy of <strong>89%</strong> – another impressive jump of <strong>3.5%</strong> from our earlier best of 85.5%.</p> </blockquote> <p>A leap from 77% to 89% accuracy – exploration definitely goes a long way!</p> <p><small>We are striving to release wink-nlp’s first version in next few weeks, <a href="/blog/naive-bayes-gets-sentimental.html#signup">sign-up</a> here for an early preview of the same.</small></p> <hr> </main> <meta name="twitter:card" content=summary_large_image /> <meta name="twitter:site" content="@winkjs_org"/> <meta name="twitter:creator" content="@R4CHN4"/> <meta property="og:url" content="https://winkjs.org/blog/2019-03-01-naive-bayes-gets-sentimental.html"/> <meta property="og:title" content="Naive Bayes gets Sentimental"/> <meta property="og:description" content="A quick experiment with the wink-naive-bayes-text-classifier for negative/positive sentiment classification."/> <meta property="og:image" content="https://winkjs.org/images/nbc-sentimental.png"/> <meta property="og:type" content=article /> </article> <div class="col-md-4 col-md-offset-2"> <h2>Packages</h2> <br> <dt> <a href="https://winkjs.org/wink-naive-bayes-text-classifier/"> naive bayes text classifier </a> </dt> <dd> Configurable Naive Bayes Classifier for text with cross-validation support. </dd> <br> <dt> <a href="https://winkjs.org/wink-sentiment/"> sentiment </a> </dt> <dd> Accurate and fast sentiment scoring of phrases with emoticons & emojis. </dd> <br> <dt> <a href="https://winkjs.org/wink-nlp-utils/"> nlp utils </a> </dt> <dd> NLP Functions for amplifying negations, managing elisions, creating ngrams, stems, phonetic codes to tokens and more. </dd> <br> <dt> <a href="https://winkjs.org/wink-perceptron/"> perceptron </a> </dt> <dd> Multi-class averaged perceptron. </dd> <br><br><br> </div> <div class=col-md-4> <h2>Recent posts</h2> <h4> <a href="/blog/browser-search.html">On Browser Search using Wink</a> </h4> <h4> <a href="/blog/naive-bayes-gets-sentimental.html">Naive Bayes gets Sentimental</a> </h4> <h4> <a href="/blog/sentimental-ai.html">Sentimental AI</a> </h4> <h4> <a href="/blog/nlp-in-agriculture.html">NLP in Agriculture</a> </h4> <br><br><br> </div> </div> <div class=signup id=signup> <div class=container> <div class="col-md-8 msg"> <h2>Sign up for updates</h2> <p>Get occasional updates from our team about new releases, guides and showcases.</p> <div id=mc_embed_signup> <form action="https://winkjs.us12.list-manage.com/subscribe/post?u=d3c950efd6a89418263b00990&amp;id=8fa8c3e2a7" method=post id=mc-embedded-subscribe-form name=mc-embedded-subscribe-form class=validate target=_blank novalidate> <div id=mc_embed_signup_scroll> <div class=mc-field-group> <input type=email value="" name=EMAIL class="required email" id=mce-EMAIL placeholder="your@email.com"> </div> <div id=mce-responses class=clear> <div class=response id=mce-error-response style="display:none"></div> <div class=response id=mce-success-response style="display:none"></div> </div> <div style="position: absolute; left: -5000px;" aria-hidden=true><input name=b_d3c950efd6a89418263b00990_8fa8c3e2a7 tabindex=-1 value=""></div> <div class=clear><input type=submit value=Subscribe name=subscribe id=mc-embedded-subscribe class=button></div> </div> </form> </div> </div> <div class=col-md-4> <h2>Get in touch</h2> <p>We provide consulting, education, and mentoring services. Get in touch at <a href="mailto:contactus@graype.in">contactus@graype.in</a>.</p> <br><br> <a class=github-button href="https://github.com/winkjs" data-size=large aria-label="Follow @winkjs on GitHub">Visit @winkjs</a> &nbsp;&nbsp; <a href="https://twitter.com/winkjs_org?ref_src=twsrc%5Etfw" class=twitter-follow-button data-size=large data-dnt=true data-show-count=false>Follow @winkjs_org</a><script async src="https://platform.twitter.com/widgets.js" charset=utf-8></script> <script async defer src="https://buttons.github.io/buttons.js"></script> </div> </div> </div> <footer> <div class=container> <div class=row> <div class=col-md-6> <p> &copy; <a href="http://graype.in">graype systems</a> pvt. ltd. </p> </div> <div class="col-md-6 social-icons"> <ul> <li> <a href="https://twitter.com/winkjs_org/"> <img src="/images/twitter.svg" alt=twitter class=twitter> </a> </li> <li> <a href="https://github.com/winkjs"> <img src="/images/github.svg" alt=github class=github> </a> </li> <li> <a href="/packages.html"> <img src="/images/package.svg" alt=package class=package> </a> </li> </ul> </div> </div> </div> </footer> <script src="/javascripts/highlight.pack.js"></script> <script src="/javascripts/jquery.min.js"></script> <script src="/javascripts/bootstrap.min.js"></script> <script>hljs.initHighlightingOnLoad();</script> <script src="/javascripts/viz.js"></script> <script src="/javascripts/particles.min.js"></script> <script src="/javascripts/headroom.js"></script> <script>
  var myElement = document.querySelector(".navbar");
  var headroom  = new Headroom(myElement, {
    "offset": 205,
    "tolerance": 5,
  });
  headroom.init();
</script> </body> </html>